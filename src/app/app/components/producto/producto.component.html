<div class="productos-container">
  <!-- Header -->
  <div class="header">
    <div class="header-content">
      <h1 class="titulo">Productos</h1>
      <p class="subtitulo">Gesti√≥n de productos e inventario</p>
    </div>
    <button class="btn-nuevo" (click)="nuevoProducto()">
      <i class="icon-plus">+</i>
      Nuevo Producto
    </button>
  </div>

  <!-- Barra de b√∫squeda -->
  <div class="search-bar">
    <div class="search-input-container">
      <i class="icon-search">üîç</i>
      <input 
        type="text" 
        class="search-input" 
        placeholder="Buscar por nombre o c√≥digo..."
        [value]="busqueda"
        (input)="busqueda = $any($event.target).value; filtrarProductos()"
      >
    </div>
    <button class="btn-refresh" (click)="cargarProductos()" title="Actualizar">
      <i class="icon-refresh">‚Üª</i>
    </button>
  </div>

  <!-- Mensaje de error -->
  <div class="alert alert-error" *ngIf="error">
    <span class="alert-icon">‚ö†Ô∏è</span>
    {{ error }}
  </div>

  <!-- Loading -->
  <div class="loading" *ngIf="cargando">
    <div class="spinner"></div>
    <p>Cargando productos...</p>
  </div>

  <!-- Tabla de productos -->
  <div class="table-container" *ngIf="!cargando">
    <table class="data-table">
      <thead>
        <tr>
          <th>C√≥digo</th>
          <th>Nombre</th>
          <th>Precio</th>
          <th>IVA</th>
          <th>Cantidad</th>
          <th>Estado</th>
          <th class="acciones-header">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let producto of productosFiltrados" class="table-row">
          <td class="codigo">{{ producto.codigo }}</td>
          <td class="nombre">{{ producto.nombre }}</td>
          <td class="precio">{{ formatearPrecio(producto.precio) }}</td>
          <td class="iva">
            <span class="badge" [class.badge-si]="producto.aplicaIVA" [class.badge-no]="!producto.aplicaIVA">
              {{ producto.aplicaIVA ? 'S√≠' : 'No' }}
            </span>
          </td>
          <td class="cantidad">
            <span class="badge-cantidad" 
                  [class.badge-bajo]="producto.cantidadDisponible <= 10"
                  [class.badge-medio]="producto.cantidadDisponible > 10 && producto.cantidadDisponible <= 50"
                  [class.badge-alto]="producto.cantidadDisponible > 50">
              {{ producto.cantidadDisponible }} unidades
            </span>
          </td>
          <td class="estado">
            <span class="badge-estado"
                  [class.badge-disponible]="producto.cantidadDisponible > 0"
                  [class.badge-agotado]="producto.cantidadDisponible === 0">
              {{ producto.cantidadDisponible > 0 ? 'Disponible' : 'Agotado' }}
            </span>
          </td>
          <td class="acciones">
            <button 
              class="btn-icon btn-editar" 
              (click)="editarProducto(producto)"
              title="Editar">
              <i class="icon-edit">‚úèÔ∏è</i>
            </button>
            <button 
              class="btn-icon btn-eliminar" 
              (click)="confirmarEliminar(producto)"
              title="Eliminar">
              <i class="icon-delete">üóëÔ∏è</i>
            </button>
          </td>
        </tr>
        <tr *ngIf="productosFiltrados.length === 0" class="empty-row">
          <td colspan="7" class="empty-message">
            <div class="empty-state">
              <i class="icon-empty">üì¶</i>
              <p>No se encontraron productos</p>
              <button class="btn-nuevo-empty" (click)="nuevoProducto()">
                Agregar primer producto
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Modal de confirmaci√≥n de eliminaci√≥n -->
  <div class="modal-overlay" *ngIf="mostrarModalEliminar" (click)="cancelarEliminar()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>Confirmar Eliminaci√≥n</h3>
        <button class="btn-close" (click)="cancelarEliminar()">√ó</button>
      </div>
      <div class="modal-body">
        <p>¬øEst√° seguro que desea eliminar el producto?</p>
        <div class="producto-info" *ngIf="productoSeleccionado">
          <p><strong>Nombre:</strong> {{ productoSeleccionado.nombre }}</p>
          <p><strong>C√≥digo:</strong> {{ productoSeleccionado.codigo }}</p>
          <p><strong>Cantidad disponible:</strong> {{ productoSeleccionado.cantidadDisponible }} unidades</p>
        </div>
        <p class="warning-text">Esta acci√≥n no se puede deshacer.</p>
      </div>
      <div class="modal-footer">
        <button class="btn-cancelar" (click)="cancelarEliminar()">
          Cancelar
        </button>
        <button class="btn-confirmar-eliminar" (click)="eliminarProducto()">
          Eliminar
        </button>
      </div>
    </div>
  </div>
</div>